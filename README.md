#闵行区二手房可视化及评价

## 程序开发目标
· 本网页分为三个子界面
* page1 通过输入目标地区的链家网址（url）,生成输出二手房数据
* page2 展示闵行区所有二手房的相关信息，通过输入对房价、面积的范围限制，筛选出符合条件的房源，并在地图上可视化，直观体现位置分布
* page3 选择想深入了解的房源，进行教育、交通、医疗、餐饮要素便利程度指标分析，展示房源附近poi和目标房源综合得分，供买房者参考
  
## 功能
1. 爬取数据，位置、户型、面积、单价、总价、标题、相关信息、链接获取
2. 目标房源可视化
3. 通过房价、面积筛选房源
3. 获取目标房源周围十公里的教育、医疗、餐饮、交通poi数据，计算出其驾车距离和时间
4. 房源得分总和计算、可视化展示


## 方法
1. 数据采集
* 从链家二手房网站爬取到闵行区所有房源信息，包括位置、户型、面积、单价、总价、标题、相关信息、链接
* 从百度地图开发平台获取密钥，获取其POI、地理编码、轻量级路线规划服务API
* 通过API，获取教育、交通、医疗、餐饮的poi名称、经纬度、到目标点的通勤距离和通勤时间
***
2. 数据处理
  1. 数据清洗：
	  1.爬取的房源数据部分无法进行地理编码，经纬度数据为unknown，可视化时进行剔除
    2.爬取到的房源数据中总价、面积含单位且为str格式，用最大最小值比较时需要剔除---使用apply(lambda x:x[0:-1]).astype('float')实现剔除单位和转换格式
    3.将获取到的poi数据去除无用部分，只保留名称和经纬度信息---使用filter函数筛选字典需要键，生成子字典
    4.poi数据和房源数据中的经纬度信息均是合并的，前者为str格式的dict，用eval(row['location']).values()分离；后者为list[lng,lat]，用apply(lambda x: pd.Series(eval(x)))分离
  2. 数据转换：将数据转换为可处理的格式，如从CSV、Excel格式转换为DataFrame格式；poi数据中经纬度键值对为str类型，用ast.literal_eval遍历转换

***
3. 数据分析
*  房源总价、面积筛选：将总价最低、最高、面积最低、最高分别与房源信息比较产生布尔值类型的Series对象exp1、exp2、exp3、exp4，再通过取交集&获得最终exp，subset = df1[exp]则以exp为索引返回值为True的记录。
* 交通距离和时间计算：利用百度地图API获得两地驾车所需时间和距离，注意时间单位为秒，距离单位为米
* 计算便利程度综合指标：对房源到周围教育、医疗、餐饮、交通poi的交通距离和时间进行得分计算。赋值时间和距离六四权重，设定最远通勤距离为5km、最大通勤时间为1h，并反距离加权计算，每种要素得分范围为0-1，将得分总和，范围为0-4。
***
4. 数据可视化
* 地图可视化：使用Python的Folium库进行地图可视化。
* Web应用可视化：使用Python的streamlit库实现web展示，将地图和图表可视化展示在Web页面上。

## 不足之处
* 程序实际运行时间长，代码仍需优化
